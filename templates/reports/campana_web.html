{% extends 'reports/base.html' %}

{% load report_tags %}

{% load humanize %}

{% block title %}Resumen Campaña Web{% endblock %}

{% block content %}

          <h1 class="page-header">Resumen Campaña Web</h1>
          <div class="form-inline">
            <input type="hidden" id="csrfmiddlewaretoken" value="{{csrf_token}}">
          </div>
          <div class="table-responsive">
            <table class="table table-campanaweb">
              <thead>
                <tr>
                  <th rowspan="2" style="vertical-align:middle;">N°<br/>Eval.</th>
                  <th rowspan="2" style="vertical-align:middle;">Recepción<br/> de base</th>
                  <th rowspan="2" style="vertical-align:middle;">Total clientes<br/> recibidos (1)</th>
                  <th colspan="3" style="vertical-align:middle;">Aprueban Filtros Duros (2)</th>
                  <th colspan="5" style="vertical-align:middle;">Ofertas TDC</th>
                  <th colspan="4" style="vertical-align:middle;">Ofertas PLD</th>
                  <th colspan="4" style="vertical-align:middle;">Efectividad - Formalizados</th>
                </tr>
                <tr>
                  <th style="vertical-align:middle;">Formu. TDC</th>
                  <th style="vertical-align:middle;">Formu. PLD</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">Oferta<br/> en Moi</th>
                  <th style="vertical-align:middle;">Incr.</th>
                  <th style="vertical-align:middle;">Nueva<br/> Oferta</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">%</th>
                  <th style="vertical-align:middle;">Oferta<br/> en Moi</th>
                  <th style="vertical-align:middle;">Nueva<br/> Oferta</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">%</th>
                  <th style="vertical-align:middle;">TDC</th>
                  <th style="vertical-align:middle;">% Form</th>
                  <th style="vertical-align:middle;">PLD</th>
                  <th style="vertical-align:middle;">% Form</th>
                </tr>
              </thead>
              <tbody >
		{% for a in campanaweb %}
		<tr>                       
                  <td>{{a.num_eval}}</td>
                  <td>{{a.fecha_recepcion}}</td>
                  <td><font color="#094FA4"><b>{{a.num_clientes|to_int|intcomma}}</b></font></td>
                  <td>{{a.form_tdc|to_int|intcomma}}</td>
                  <td>{{a.form_pld|to_int|intcomma}}</td>
                  <td><font color="#094FA4"><b>{{a.total_filtros|to_int|intcomma}}</b></font></td>
                  <td>{{a.tdc_moi|to_int|intcomma}}</td>
                  <td>{{a.tdc_il|to_int|intcomma}}</td>
                  <td>{{a.tdc_nueva|to_int|intcomma}}</td>
                  <td>{{a.tdc_total|to_int|intcomma}}</td>
                  <td>{{a.tdc_porcentaje|to_int}}%</td>
                  <td>{{a.pld_moi|to_int|intcomma}}</td>
                  <td>{{a.pld_nueva|to_int|intcomma}}</td>
                  <td>{{a.pld_total|to_int|intcomma}}</td>
                  <td>{{a.pld_porcentaje|to_int}}%</td>
                  <td>{{a.tdc|to_int|intcomma}}</td>
                  <td>{{a.tdc_formal|to_int|intcomma}}</td>
                  <td>{{a.pld|to_int|intcomma}}</td>
                  <td>{{a.pld_formal|to_int}}%</td>
                </tr>
		{% endfor %}
              </tbody>
	      <tfoot>
		<tr>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th></th>
                  <th style="vertical-align:middle;">{{totales.total1|to_int|intcomma}}</th>
                  <th colspan="2" style="vertical-align:middle;">{{totales.total2|to_int|intcomma}}</th>
                  <th></th>
                  <th style="vertical-align:middle;">{{totales.total3|to_int|intcomma}}</th>
                  <th colspan="2" style="vertical-align:middle;">{{totales.total4|to_int|intcomma}}</th>
                  <th style="vertical-align:middle;">{{totales.total5|to_int|intcomma}}</th>
                  <th></th>
                  <th style="vertical-align:middle;">{{totales.total6|to_int|intcomma}}</th>
                  <th></th>
	      </tfoot>
            </table>
          </div>
	  <div>(1) Solo se esta contabilizando una solicitud por cliente, en las bases recibidas se han encontrado más de una solicitud de una misma persona.</div>
	  <div>(2) Se retiran aquellos clientes con mal comportamiento en SF, BBVA, Mal buro, bases negativas, edad>75 y aquellos que ya fueron evaluados por el circuito.</div>
          &nbsp;&nbsp;
	  <center>
	  <h2>Efectividad por Requerimiento de exoneración - TDC</h2>
          &nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 40%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th></th>
                  <th style="vertical-align:middle;">Ex.<br/>Ambas</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VD</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VL</th>
                  <th style="vertical-align:middle;">Requiere<br/>ambas</th>
                  <th style="vertical-align:middle;">Total</th>
                </tr>
              </thead>
              <tbody >
		{% for a in tdc_campanaefec %}
		<tr>                       
                  <td>{{a.segmento1}}</td>
                  <td>{{a.exo_ambas}}</td>
                  <td>{{a.exo_solovd}}</td>
                  <td>{{a.exo_solovl}}</td>
                  <td>{{a.requiere_ambas}}</td>
                  <td>{{a.total}}</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 30%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th></th>
                  <th style="vertical-align:middle;">Nueva<br/>Oferta</th>
                  <th style="vertical-align:middle;">Form</th>
                  <th style="vertical-align:middle;">%<br/>Form</th>
                </tr>
              </thead>
              <tbody >
		{% for a in tdc_campanaefec2 %}
		<tr>                       
                  <td>{{a.segmento1}}</td>
                  <td>{{a.total_apro}}</td>
                  <td>{{a.form}}</td>
                  <td>{{a.porc_form}}</td>
                </tr>
		{% endfor %}
		<tr>                       
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </tr>
		<tr>                       
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="table-responsive" style="height: auto; width: 50%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                 <tr>
                  <th bgcolor="white"></th>
                  <th></th>
                  <th style="vertical-align:middle;">Ex.<br/>Ambas</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VD</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VL</th>
                  <th style="vertical-align:middle;">Requiere<br/>ambas</th>
                  <th style="vertical-align:middle;">Total</th>
                </tr>
              </thead>
              <tbody >
                  <td rowspan="9" style="vertical-align:middle;" bgcolor="skyblue">EQUIFAX</td>
		{% for a in tdc_equifax %}
		<tr>                       
                  <td>{{a.segmento1}}</td>
                  <td>{{a.exo_ambas}}</td>
                  <td>{{a.exo_solovd}}</td>
                  <td>{{a.exo_solovl}}</td>
                  <td>{{a.requiere_ambas}}</td>
                  <td>{{a.total}}</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
	  </center>
          &nbsp;&nbsp;
	  <center>
	  <h2>Efectividad por Requerimiento de exoneración - PLD</h2>
          &nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 40%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th></th>
                  <th style="vertical-align:middle;">Ex.<br/>Ambas</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VD</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VL</th>
                  <th style="vertical-align:middle;">Requiere<br/>ambas</th>
                  <th style="vertical-align:middle;">Total</th>
                </tr>
              </thead>
              <tbody >
		{% for a in pld_campanaefec %}
		<tr>                       
                  <td>{{a.segmento1}}</td>
                  <td>{{a.exo_ambas}}</td>
                  <td>{{a.exo_solovd}}</td>
                  <td>{{a.exo_solovl}}</td>
                  <td>{{a.requiere_ambas}}</td>
                  <td>{{a.total}}</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 30%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th></th>
                  <th style="vertical-align:middle;">Nueva<br/>Oferta</th>
                  <th style="vertical-align:middle;">Form</th>
                  <th style="vertical-align:middle;">%<br/>Form</th>
                </tr>
              </thead>
              <tbody >
		{% for a in pld_campanaefec2 %}
		<tr>                       
                  <td>{{a.segmento1}}</td>
                  <td>{{a.total_apro}}</td>
                  <td>{{a.form}}</td>
                  <td>{{a.porc_form}}</td>
                </tr>
		{% endfor %}
		<tr>                       
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </tr>
		<tr>                       
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="table-responsive" style="height: auto; width: 50%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                 <tr>
                  <th bgcolor="white"></th>
                  <th></th>
                  <th style="vertical-align:middle;">Ex.<br/>Ambas</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VD</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VL</th>
                  <th style="vertical-align:middle;">Requiere<br/>ambas</th>
                  <th style="vertical-align:middle;">Total</th>
                </tr>
              </thead>
              <tbody >
                  <td rowspan="9" style="vertical-align:middle;" bgcolor="skyblue">EQUIFAX</td>
		{% for a in pld_equifax %}
		<tr>                       
                  <td>{{a.segmento1}}</td>
                  <td>{{a.exo_ambas}}</td>
                  <td>{{a.exo_solovd}}</td>
                  <td>{{a.exo_solovl}}</td>
                  <td>{{a.requiere_ambas}}</td>
                  <td>{{a.total}}</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
	  </center>
	  <center>
	  <h2>Efectividad de Mejoras TDC</h2>
          &nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 40%;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th bgcolor="white"> </th>
                  <th style="vertical-align:middle;">Ex.<br/>Ambas</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VD</th>
                  <th style="vertical-align:middle;">Ex. Sólo<br/>VL</th>
                  <th style="vertical-align:middle;">Requiere<br/>ambas</th>
                  <th style="vertical-align:middle;">Total</th>
                </tr>
              </thead>
              <tbody >
		{% for a in tdc_mejoras %}
		<tr>                       
                  <td>{{a.segmento1}}</td>
                  <td>{{a.exo_ambas}}</td>
                  <td>{{a.exo_solovd}}</td>
                  <td>{{a.exo_solovl}}</td>
                  <td>{{a.requiere_ambas}}</td>
                  <td>{{a.total}}</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
	  </center>
	  <center>
	  <h2>Situación Laboral - Segmentos</h2>
          &nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 40%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th colspan="4" style="vertical-align:middle;">Situación Laboral</th>
                </tr>
                <tr>
                  <th bgcolor="white">POWER</th>
                  <th style="vertical-align:middle;">Form</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">% Form</th>
                </tr>
              </thead>
              <tbody >
		{% for a in power_lab %}
		<tr>                       
                  <td>{{a.filtro2}}</td>
                  <td>{{a.form}}</td>
                  <td>{{a.total_form}}</td>
                  <td>{{a.porc_form}}</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 40%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th colspan="4" style="vertical-align:middle;">Segmentos</th>
                </tr>
                <tr>
                  <th bgcolor="white">POWER</th>
                  <th style="vertical-align:middle;">Form</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">% Form</th>
                </tr>
              </thead>
              <tbody >
		{% for a in power_seg %}
		<tr>                       
                  <td>{{a.filtro2}}</td>
                  <td>{{a.form}}</td>
                  <td>{{a.total_form}}</td>
                  <td>{{a.porc_form}}</td>
                </tr>
		{% endfor %}
		<tr>                       
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </tr>
              </tbody>
            </table>
          </div>
	  </center>
	  <center>
          <div class="table-responsive" style="height: auto; width: 40%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th colspan="4" style="vertical-align:middle;">Situación Laboral</th>
                </tr>
                <tr>
                  <th bgcolor="white">PULPIN</th>
                  <th style="vertical-align:middle;">Form</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">% Form</th>
                </tr>
              </thead>
              <tbody >
		{% for a in pulpin_lab %}
		<tr>                       
                  <td>{{a.filtro2}}</td>
                  <td>{{a.form}}</td>
                  <td>{{a.total_form}}</td>
                  <td>{{a.porc_form}}</td>
                </tr>
		{% endfor %}
		<tr>                       
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </tr>
              </tbody>
            </table>
          </div>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <div class="table-responsive" style="height: auto; width: 40%; display: inline-block;">
            <table class="table table-campanaefec">
              <thead>
                <tr>
                  <th colspan="4" style="vertical-align:middle;">Segmentos</th>
                </tr>
                <tr>
                  <th bgcolor="white">PULPIN</th>
                  <th style="vertical-align:middle;">Form</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">% Form</th>
                </tr>
              </thead>
              <tbody >
		{% for a in pulpin_seg %}
		<tr>                       
                  <td>{{a.filtro2}}</td>
                  <td>{{a.form}}</td>
                  <td>{{a.total_form}}</td>
                  <td>{{a.porc_form}}</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
	  </center>

{% endblock %}

{% block script_final %}
  <script type="text/javascript">
    window.onload = function () {
	var chart = new CanvasJS.Chart("chartContainer", {
		theme: "theme2",//theme1
		title:{
			text: "Participación de Inversión por territorio"              
		},
		animationEnabled: true,   // change to true

		data: [ 
		{
			// Change type to "bar", "area", "spline", "pie",etc.
			type: "doughnut",
			indexLabel: "{y}",
			startAngle: 0,
			yValueFormatString: "###.##",
			//name: "BCP",
			//color: "#F6891E",			
			//showInLegend: "true",
			dataPoints: [
			{% for a in conce %} 			
				{ y: {{a.sum_inv}} , indexLabel: "{{a.territorio}}"  },
		        {% endfor %}
			]

		},
		]
	});
	chart.render();

    }
  </script>
{% endblock %}

