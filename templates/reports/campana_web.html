{% extends 'reports/base.html' %}

{% load report_tags %}

{% load humanize %}

{% block title %}Resumen Campaña Web{% endblock %}

{% block content %}

          <h1 class="page-header">Resumen Campaña Web</h1>
          <div class="form-inline">
            <input type="hidden" id="csrfmiddlewaretoken" value="{{csrf_token}}">
          </div>
          <div class="table-responsive">
            <table class="table table-campanaweb">
              <thead>
                <tr>
                  <th colspan="2" style="vertical-align:middle;">Fecha de Solicitudes</th>
                  <th rowspan="2" style="vertical-align:middle;">Recepción<br/> de base</th>
                  <th rowspan="2" style="vertical-align:middle;">Total clientes<br/> recibidos (1)</th>
                  <th colspan="3" style="vertical-align:middle;">Aprueban Filtros Duros (2)</th>
                  <th colspan="5" style="vertical-align:middle;">Ofertas TDC</th>
                  <th colspan="4" style="vertical-align:middle;">Ofertas PLD</th>
                </tr>
                <tr>
                  <th style="vertical-align:middle;">Desde</th>
                  <th style="vertical-align:middle;">Hasta</th>
                  <th style="vertical-align:middle;">Formulario TDC</th>
                  <th style="vertical-align:middle;">Formulario PLD</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">Oferta<br/> en Moi</th>
                  <th style="vertical-align:middle;">Oferta<br/> de IL</th>
                  <th style="vertical-align:middle;">Nueva Oferta</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">%</th>
                  <th style="vertical-align:middle;">Oferta<br/> en Moi</th>
                  <th style="vertical-align:middle;">Nueva Oferta</th>
                  <th style="vertical-align:middle;">Total</th>
                  <th style="vertical-align:middle;">%</th>
                </tr>
              </thead>
              <tbody >
		{% for a in campanaweb %}
		<tr>                       
                  <td>{{a.fecha_desde}}</td>
                  <td>{{a.fecha_hasta}}</td>
                  <td>{{a.fecha_recepcion}}</td>
                  <td>{{a.num_clientes|to_int|intcomma}}</td>
                  <td>{{a.form_tdc|to_int|intcomma}}</td>
                  <td>{{a.form_pld|to_int|intcomma}}</td>
                  <td>{{a.total_filtros|to_int|intcomma}}</td>
                  <td>{{a.tdc_moi|to_int|intcomma}}</td>
                  <td>{{a.tdc_il|to_int|intcomma}}</td>
                  <td>{{a.tdc_nueva|to_int|intcomma}}</td>
                  <td>{{a.tdc_total|to_int|intcomma}}</td>
                  <td>{{a.tdc_porcentaje|x_cien|to_int}}%</td>
                  <td>{{a.pld_moi|to_int|intcomma}}</td>
                  <td>{{a.pld_nueva|to_int|intcomma}}</td>
                  <td>{{a.pld_total|to_int|intcomma}}</td>
                  <td>{{a.pld_porcentaje|x_cien|to_int}}%</td>
                </tr>
		{% endfor %}
              </tbody>
            </table>
          </div>
	  <div>(1) Solo se esta contabilizando una solicitud por cliente, en las bases recibidas se han encontrado más de una solicitud de una misma persona.</div>
	  <div>(2) Se retiran aquellos clientes con mal comportamiento en SF, BBVA, Mal buro, bases negativas, edad>75 y aquellos que ya fueron evaluados por el circuito.</div>


{% endblock %}

{% block script_final %}
  <script type="text/javascript">
    window.onload = function () {
	var chart = new CanvasJS.Chart("chartContainer", {
		theme: "theme2",//theme1
		title:{
			text: "Participación de Inversión por territorio"              
		},
		animationEnabled: true,   // change to true

		data: [ 
		{
			// Change type to "bar", "area", "spline", "pie",etc.
			type: "doughnut",
			indexLabel: "{y}",
			startAngle: 0,
			yValueFormatString: "###.##",
			//name: "BCP",
			//color: "#F6891E",			
			//showInLegend: "true",
			dataPoints: [
			{% for a in conce %} 			
				{ y: {{a.sum_inv}} , indexLabel: "{{a.territorio}}"  },
		        {% endfor %}
			]

		},
		]
	});
	chart.render();

    }
  </script>
{% endblock %}

